const { Room, Booking } = require("./index");

describe("Testing for Rooms and Bookings", () => {
    it("Check if room is occupied on determined date", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        expect(room.isOccupied(new Date("12-31-2023"))).toBe(true);
        expect(room.isOccupied(new Date("12-31-2022"))).toBe(false);
        expect(room.isOccupied(new Date("10-10-1759"))).toBe(true);
        expect(room.isOccupied(new Date("01-01-1999"))).toBe(false);
    });
    it("Invalid dates for bookings", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", true, "new Date()", 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", 31415926, undefined, 10, room);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        expect(room.isOccupied(new Date("12-31-2023"))).toThrow();
        expect(room.isOccupied(new Date("12-31-2022"))).toThrow();
        expect(room.isOccupied(new Date("10-10-1759"))).toThrow();
        expect(room.isOccupied(new Date("01-01-1999"))).toThrow();
    });
    it("Invalid dates passed to isOccupied", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        expect(room.isOccupied(true)).toThrow();
        expect(room.isOccupied("Generic phrase")).toThrow();
        expect(room.isOccupied(1234)).toThrow();
        expect(room.isOccupied(undefined)).toThrow();
    });
    // it("Invalid type (non-array) for bookings in Room object", () => {
    //     const room = new Room("First Room", true, 17000, 25);
    //     const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
    //     const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
    //     room.bookings.push(booking1);
    //     room.bookings.push(booking2);
    //     expect(room.isOccupied(new Date("12-31-2023"))).toBe(true);
    //     expect(room.isOccupied(new Date("12-31-2022"))).toBe(false);
    //     expect(room.isOccupied(new Date("10-10-1759"))).toBe(true);
    //     expect(room.isOccupied(new Date("01-01-1999"))).toBe(false);
    // });
    it("Check if room is occupied on determined date", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        expect(room.occupancyPercentage(new Date("01-01-2024"), new Date("01-11-2024"))).toBe("50%");
        expect(room.occupancyPercentage(new Date("12-25-2023"), new Date("01-18-2024"))).toBe("50%");
        expect(room.occupancyPercentage(new Date("12-27-2023"), new Date("01-03-2024"))).toBe("100%");
    });
    it("Invalid type for occupancyArray", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        expect(room.occupancyPercentage(true, false)).toBe("NaN%");
        expect(room.occupancyPercentage(undefined, null)).toBe("NaN%");
        expect(room.occupancyPercentage("Hi!", 12345)).toBe("NaN%");
    });
    it("Check total occupancy in list of rooms", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        const room2 = new Room("Second Room", [], 25000, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room2);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        room2.bookings.push(booking3);
        room2.bookings.push(booking4);
        expect(Room.totalOccupancyPercentage([room, room2], new Date("01-01-2024"), new Date("01-11-2024"))).toEqual(["50%", "0%"]);
    });
    it("Invalid types for dates instead of dates", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        const room2 = new Room("Second Room", [], 25000, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room2);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        room2.bookings.push(booking3);
        room2.bookings.push(booking4);
        expect(Room.totalOccupancyPercentage([room, room2], undefined, null)).toEqual(["NaN%", "NaN%"]);
        expect(Room.totalOccupancyPercentage([room, room2], 12345, "OneTwoThreeFourFive")).toEqual(["NaN%", "NaN%"]);
        expect(Room.totalOccupancyPercentage([room, room2], true, false)).toEqual(["NaN%", "NaN%"]);
    });
    it("Invalid data instead of arrays", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        const room2 = new Room("Second Room", [], 25000, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room2);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        room2.bookings.push(booking3);
        room2.bookings.push(booking4);
        expect(() => Room.totalOccupancyPercentage(undefined, new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
        expect(() => Room.totalOccupancyPercentage(null, new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
        expect(() => Room.totalOccupancyPercentage("Thirteen", new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
        expect(() => Room.totalOccupancyPercentage(1234, new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
        expect(() => Room.totalOccupancyPercentage(true, new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
    });
    it("Check total available rooms", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        const room2 = new Room("Second Room", [], 25000, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room2);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        room2.bookings.push(booking3);
        room2.bookings.push(booking4);
        expect(Room.availableRooms([room, room2], new Date("01-01-2024"), new Date("01-11-2024"))).toEqual([room2]);
    });
    it("Invalid types for dates instead of dates", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        const room2 = new Room("Second Room", [], 25000, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room2);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        room2.bookings.push(booking3);
        room2.bookings.push(booking4);
        expect(Room.availableRooms([room, room2], undefined, null)).toEqual([]);
        expect(Room.availableRooms([room, room2], 12345, "OneTwoThreeFourFive")).toEqual([]);
        expect(Room.availableRooms([room, room2], true, false)).toEqual([]);
    });
    it("Invalid data instead of arrays", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        const room2 = new Room("Second Room", [], 25000, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room2);
        room.bookings.push(booking1);
        room.bookings.push(booking2);
        room2.bookings.push(booking3);
        room2.bookings.push(booking4);
        expect(() => Room.availableRooms(undefined, new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
        expect(() => Room.availableRooms(null, new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
        expect(() => Room.availableRooms("Thirteen", new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
        expect(() => Room.availableRooms(1234, new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
        expect(() => Room.availableRooms(true, new Date("01-01-2024"), new Date("01-11-2024"))).toThrow(TypeError);
    });
    it("Check total available rooms", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        const room2 = new Room("Second Room", [], 25000, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room2);
        expect(booking1.getFee()).toBe(11475);
        expect(booking2.getFee()).toBe(11475);
        expect(booking3.getFee()).toBe(17000);
        expect(booking4.getFee()).toBe(12000);
    });
    it("Using negative values", () => {
        const room = new Room("First Room", [], 17000, -25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), -10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        const room2 = new Room("Second Room", [], -25000, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), -40, room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room2);
        expect(booking1.getFee()).toBe(23375);
        expect(booking2.getFee()).toBe(19125);
        expect(booking3.getFee()).toBe(-28000);
        expect(booking4.getFee()).toBe(-12000);
    });
    it("Invalid values for price", () => {
        const room = new Room("First Room", [], undefined, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), 10, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), 10, room);
        const room2 = new Room("Second Room", [], null, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room2);
        const room3 = new Room("Second Room", [], "Some text", 20);
        const booking5 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room3);
        const booking6 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room3);
        const room4 = new Room("Second Room", [], false, 20);
        const booking7 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), 15, room4);
        const booking8 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), 40, room4);
        expect(booking1.getFee()).toBe(NaN);
        expect(booking2.getFee()).toBe(NaN);
        expect(booking3.getFee()).toBe(0);
        expect(booking4.getFee()).toBe(0);
        expect(booking5.getFee()).toBe(NaN);
        expect(booking6.getFee()).toBe(NaN);
        expect(booking7.getFee()).toBe(0);
        expect(booking8.getFee()).toBe(0);
    });
    it("Invalid values for discounts", () => {
        const room = new Room("First Room", [], 17000, 25);
        const booking1 = new Booking("Peter Peterson", "peterpeter@gmail.com", new Date("12-25-2023"), new Date("01-06-2024"), undefined, room);
        const booking2 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("02-07-1758"), new Date("04-13-1762"), null, room);
        const room2 = new Room("Second Room", [], 25000, 20);
        const booking3 = new Booking("David Burguete", "dburgueteg@gmail.com", new Date("03-13-2020"), new Date("09-01-2020"), "This is a discount", room2);
        const booking4 = new Booking("Thor Odinson", "godofthunder@asgard.nine.realms", new Date("04-08-2025"), new Date("04-15-2025"), false, room2);
        expect(booking1.getFee()).toBe(NaN);
        expect(booking2.getFee()).toBe(12750);
        expect(booking3.getFee()).toBe(NaN);
        expect(booking4.getFee()).toBe(20000);
    });
});